!=======================================================================
!
!
! fortran interfaces of internal interoperable functions
!
!
! Copyright (c) 2013, Enzo/Grackle Development Team.
!
! Distributed under the terms of the Enzo Public Licence.
!
! The full license is in the file LICENSE, distributed with this 
! software.
!=======================================================================

c Here we define the Fortran 90 interfaces to the C routines using the 2003
c   Fortran C interoperability features. Note that some care must be taken
c   defining matching types.

c before including this file, be sure that:
c   1. you have invoked ``USE ISO_C_BINDING``
c   2. grackle_fortran_types.def has already been included

      interface
        subroutine interpolate_1D_g(
     &                input1, gridDim, gridPar1, dgridPar1,
     &                dataSize, dataField, value) bind(C)
          IMPORT
          REAL(C_DOUBLE), INTENT(IN) :: input1
          INTEGER(C_LONG_LONG), INTENT(IN) :: gridDim(*)
          REAL(C_DOUBLE), INTENT(IN) :: gridPar1(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar1
          INTEGER(C_LONG_LONG), INTENT(IN) :: dataSize
          REAL(C_DOUBLE), INTENT(IN) :: dataField(*)
          REAL(C_DOUBLE), INTENT(OUT) :: value
          end subroutine interpolate_1D_g
      end interface

      interface
        subroutine interpolate_2D_g(
     &                input1, input2, gridDim,
     &                gridPar1, dgridPar1,
     &                gridPar2, dgridPar2,
     &                dataSize, dataField, value) bind(C)
          IMPORT
          REAL(C_DOUBLE), INTENT(IN) :: input1
          REAL(C_DOUBLE), INTENT(IN) :: input2
          INTEGER(C_LONG_LONG), INTENT(IN) :: gridDim(*)
          REAL(C_DOUBLE), INTENT(IN) :: gridPar1(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar1
          REAL(C_DOUBLE), INTENT(IN) :: gridPar2(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar2
          INTEGER(C_LONG_LONG), INTENT(IN) :: dataSize
          REAL(C_DOUBLE), INTENT(IN) :: dataField(*)
          REAL(C_DOUBLE), INTENT(OUT) :: value
          end subroutine interpolate_2D_g
      end interface

      interface
        subroutine interpolate_3D_g(
     &                input1, input2, input3, gridDim,
     &                gridPar1, dgridPar1,
     &                gridPar2, dgridPar2,
     &                gridPar3, dgridPar3,
     &                dataSize, dataField, value) bind(C)
          IMPORT
          REAL(C_DOUBLE), INTENT(IN) :: input1
          REAL(C_DOUBLE), INTENT(IN) :: input2
          REAL(C_DOUBLE), INTENT(IN) :: input3
          INTEGER(C_LONG_LONG), INTENT(IN) :: gridDim(*)
          REAL(C_DOUBLE), INTENT(IN) :: gridPar1(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar1
          REAL(C_DOUBLE), INTENT(IN) :: gridPar2(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar2
          REAL(C_DOUBLE), INTENT(IN) :: gridPar3(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar3
          INTEGER(C_LONG_LONG), INTENT(IN) :: dataSize
          REAL(C_DOUBLE), INTENT(IN) :: dataField(*)
          REAL(C_DOUBLE), INTENT(OUT) :: value
          end subroutine interpolate_3D_g
      end interface

      interface
        subroutine interpolate_3Dz_g(
     &                input1, input2, input3, gridDim,
     &                gridPar1, dgridPar1,
     &                gridPar2, index2,
     &                gridPar3, dgridPar3,
     &                dataSize, dataField,
     &                end_int, value) bind(C)
          IMPORT
          REAL(C_DOUBLE), INTENT(IN) :: input1
          REAL(C_DOUBLE), INTENT(IN) :: input2
          REAL(C_DOUBLE), INTENT(IN) :: input3
          INTEGER(C_LONG_LONG), INTENT(IN) :: gridDim(*)
          REAL(C_DOUBLE), INTENT(IN) :: gridPar1(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar1
          REAL(C_DOUBLE), INTENT(IN) :: gridPar2(*)
          INTEGER(C_LONG_LONG), INTENT(IN) :: index2
          REAL(C_DOUBLE), INTENT(IN) :: gridPar3(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar3
          INTEGER(C_LONG_LONG), INTENT(IN) :: dataSize
          REAL(C_DOUBLE), INTENT(IN) :: dataField(*)
          INTEGER(C_LONG_LONG), INTENT(IN) :: end_int
          REAL(C_DOUBLE), INTENT(OUT) :: value
          end subroutine interpolate_3Dz_g
      end interface

      interface
        subroutine interpolate_4D_g(
     &                input1, input2, input3, input4,
     &                gridDim,
     &                gridPar1, dgridPar1,
     &                gridPar2, dgridPar2,
     &                gridPar3, dgridPar3,
     &                gridPar4, dgridPar4,
     &                dataSize, dataField, value) bind(C)
          IMPORT
          REAL(C_DOUBLE), INTENT(IN) :: input1
          REAL(C_DOUBLE), INTENT(IN) :: input2
          REAL(C_DOUBLE), INTENT(IN) :: input3
          REAL(C_DOUBLE), INTENT(IN) :: input4
          INTEGER(C_LONG_LONG), INTENT(IN) :: gridDim(*)
          REAL(C_DOUBLE), INTENT(IN) :: gridPar1(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar1
          REAL(C_DOUBLE), INTENT(IN) :: gridPar2(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar2
          REAL(C_DOUBLE), INTENT(IN) :: gridPar3(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar3
          REAL(C_DOUBLE), INTENT(IN) :: gridPar4(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar4
          INTEGER(C_LONG_LONG), INTENT(IN) :: dataSize
          REAL(C_DOUBLE), INTENT(IN) :: dataField(*)
          REAL(C_DOUBLE), INTENT(OUT) :: value
          end subroutine interpolate_4D_g
      end interface

      interface
        subroutine interpolate_5D_g(
     &                input1, input2, input3, input4, input5,
     &                gridDim,
     &                gridPar1, dgridPar1,
     &                gridPar2, dgridPar2,
     &                gridPar3, dgridPar3,
     &                gridPar4, dgridPar4,
     &                gridPar5, dgridPar5,
     &                dataSize, dataField, value) bind(C)
          IMPORT
          REAL(C_DOUBLE), INTENT(IN) :: input1
          REAL(C_DOUBLE), INTENT(IN) :: input2
          REAL(C_DOUBLE), INTENT(IN) :: input3
          REAL(C_DOUBLE), INTENT(IN) :: input4
          REAL(C_DOUBLE), INTENT(IN) :: input5
          INTEGER(C_LONG_LONG), INTENT(IN) :: gridDim(*)
          REAL(C_DOUBLE), INTENT(IN) :: gridPar1(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar1
          REAL(C_DOUBLE), INTENT(IN) :: gridPar2(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar2
          REAL(C_DOUBLE), INTENT(IN) :: gridPar3(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar3
          REAL(C_DOUBLE), INTENT(IN) :: gridPar4(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar4
          REAL(C_DOUBLE), INTENT(IN) :: gridPar5(*)
          REAL(C_DOUBLE), INTENT(IN) :: dgridPar5
          INTEGER(C_LONG_LONG), INTENT(IN) :: dataSize
          REAL(C_DOUBLE), INTENT(IN) :: dataField(*)
          REAL(C_DOUBLE), INTENT(OUT) :: value
          end subroutine interpolate_5D_g
      end interface